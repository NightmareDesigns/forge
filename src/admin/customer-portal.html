<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CraftForge - License Verification</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0d0000 0%, #1a0000 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      max-width: 500px;
      width: 100%;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .logo {
      font-size: 48px;
      font-weight: bold;
      color: #8b0000;
      margin-bottom: 10px;
      text-shadow: 0 2px 10px rgba(139, 0, 0, 0.3);
    }

    .subtitle {
      color: #cccccc;
      font-size: 14px;
      letter-spacing: 1px;
      text-transform: uppercase;
    }

    .card {
      background: rgba(20, 20, 20, 0.8);
      backdrop-filter: blur(10px);
      border: 1px solid #8b0000;
      border-radius: 8px;
      padding: 40px;
      box-shadow: 0 8px 32px rgba(139, 0, 0, 0.2);
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      color: #cccccc;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    input {
      width: 100%;
      padding: 12px;
      background: rgba(50, 50, 50, 0.5);
      border: 1px solid #333;
      border-radius: 4px;
      color: #cccccc;
      font-size: 14px;
      transition: all 0.3s ease;
      font-family: 'Courier New', monospace;
    }

    input:focus {
      outline: none;
      border-color: #8b0000;
      background: rgba(50, 50, 50, 0.8);
      box-shadow: 0 0 10px rgba(139, 0, 0, 0.3);
    }

    input::placeholder {
      color: #666;
    }

    .button-group {
      display: flex;
      gap: 10px;
      margin-top: 30px;
    }

    button {
      flex: 1;
      padding: 12px;
      background: #8b0000;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    button:hover {
      background: #a00000;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(139, 0, 0, 0.4);
    }

    button:active {
      transform: translateY(0);
    }

    .button-secondary {
      background: transparent;
      border: 1px solid #8b0000;
      color: #8b0000;
    }

    .button-secondary:hover {
      background: rgba(139, 0, 0, 0.1);
    }

    .result {
      margin-top: 30px;
      display: none;
    }

    .result.show {
      display: block;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .result-box {
      background: rgba(139, 0, 0, 0.1);
      border: 1px solid #8b0000;
      border-radius: 4px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .status-active {
      color: #00c853;
      font-weight: 600;
    }

    .status-inactive {
      color: #ff6f00;
      font-weight: 600;
    }

    .status-expired {
      color: #d32f2f;
      font-weight: 600;
    }

    .info-label {
      color: #999;
      font-size: 12px;
      text-transform: uppercase;
      margin-top: 12px;
      margin-bottom: 4px;
    }

    .info-value {
      color: #cccccc;
      font-size: 14px;
      font-family: 'Courier New', monospace;
      word-break: break-all;
      padding: 8px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 3px;
    }

    .error {
      background: rgba(211, 47, 47, 0.1);
      border: 1px solid #d32f2f;
      color: #ff5252;
      padding: 12px;
      border-radius: 4px;
      margin-bottom: 20px;
      display: none;
      animation: slideIn 0.3s ease;
    }

    .error.show {
      display: block;
    }

    .success {
      background: rgba(0, 200, 83, 0.1);
      border: 1px solid #00c853;
      color: #69f0ae;
      padding: 12px;
      border-radius: 4px;
      margin-bottom: 20px;
      display: none;
      animation: slideIn 0.3s ease;
    }

    .success.show {
      display: block;
    }

    .loading {
      display: none;
      text-align: center;
      color: #8b0000;
    }

    .loading.show {
      display: block;
    }

    .spinner {
      border: 2px solid rgba(139, 0, 0, 0.2);
      border-top: 2px solid #8b0000;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 0.8s linear infinite;
      display: inline-block;
      margin-right: 8px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .footer {
      text-align: center;
      margin-top: 40px;
      color: #666;
      font-size: 12px;
    }

    .footer a {
      color: #8b0000;
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    @media (max-width: 600px) {
      .card {
        padding: 30px;
      }

      .logo {
        font-size: 36px;
      }

      .button-group {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">ðŸŽ¨ CraftForge</div>
      <div class="subtitle">License Verification Portal</div>
    </div>

    <div class="card">
      <div class="error" id="errorMsg"></div>
      <div class="success" id="successMsg"></div>
      <div class="loading" id="loading">
        <div class="spinner"></div>
        Verifying license...
      </div>

      <div id="formContainer">
        <div class="form-group">
          <label for="softwareNumber">Software Number</label>
          <input
            type="text"
            id="softwareNumber"
            placeholder="NM-XXXX-XXXX"
            autocomplete="off"
          />
        </div>

        <div class="form-group">
          <label for="licenseKey">License Key</label>
          <input
            type="text"
            id="licenseKey"
            placeholder="XXXXX-XXXXX-XXXXX-XXXXX"
            autocomplete="off"
          />
        </div>

        <div class="button-group">
          <button onclick="verifyLicense()">Verify License</button>
          <button class="button-secondary" onclick="clearForm()">Clear</button>
        </div>
      </div>

      <div class="result" id="resultContainer"></div>
    </div>

    <div class="footer">
      <p>Â© 2024 CraftForge. All rights reserved.</p>
      <p>
        <a href="#" onclick="showHelp()">Need help?</a> |
        <a href="#" onclick="showActivation()">How to activate</a>
      </p>
    </div>
  </div>

  <script>
    const API_URL = 'http://localhost:5000';

    function showLoading(show) {
      document.getElementById('loading').classList.toggle('show', show);
      document.getElementById('formContainer').style.display = show ? 'none' : 'block';
    }

    function showError(message) {
      const errorEl = document.getElementById('errorMsg');
      errorEl.textContent = message;
      errorEl.classList.add('show');
    }

    function showSuccess(message) {
      const successEl = document.getElementById('successMsg');
      successEl.textContent = message;
      successEl.classList.add('show');
    }

    function hideMessages() {
      document.getElementById('errorMsg').classList.remove('show');
      document.getElementById('successMsg').classList.remove('show');
    }

    async function verifyLicense() {
      hideMessages();
      const softwareNumber = document.getElementById('softwareNumber').value.trim();
      const licenseKey = document.getElementById('licenseKey').value.trim();

      if (!softwareNumber || !licenseKey) {
        showError('Please enter both Software Number and License Key');
        return;
      }

      showLoading(true);

      try {
        const response = await fetch(`${API_URL}/api/activate-license`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            softwareNumber,
            licenseKey
          })
        });

        const data = await response.json();

        if (data.error) {
          showError(data.error);
        } else {
          showSuccess(`âœ“ License verified and activated!`);
          displayLicenseInfo(data);
        }
      } catch (error) {
        showError(`Connection error: ${error.message}`);
      } finally {
        showLoading(false);
      }
    }

    function displayLicenseInfo(license) {
      const resultEl = document.getElementById('resultContainer');
      const expiryDate = new Date(license.expiryDate);
      const today = new Date();
      const daysLeft = Math.ceil((expiryDate - today) / (1000 * 60 * 60 * 24));

      let statusClass = 'status-active';
      let statusText = 'âœ“ ACTIVE';

      if (daysLeft < 0) {
        statusClass = 'status-expired';
        statusText = 'âœ— EXPIRED';
      } else if (daysLeft < 30) {
        statusClass = 'status-inactive';
        statusText = 'âš  EXPIRING SOON';
      }

      resultEl.innerHTML = `
        <div class="result-box">
          <div class="info-label">License Status</div>
          <div class="${statusClass}" style="font-size: 18px; margin-bottom: 20px;">${statusText}</div>

          <div class="info-label">Software Number</div>
          <div class="info-value">${license.softwareNumber}</div>

          <div class="info-label" style="margin-top: 16px;">License Key</div>
          <div class="info-value">${license.licenseKey}</div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 20px;">
            <div>
              <div class="info-label">License Type</div>
              <div class="info-value">${license.licenseType || 'Personal'}</div>
            </div>
            <div>
              <div class="info-label">Product</div>
              <div class="info-value">${license.productType || 'CraftForge'}</div>
            </div>
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px;">
            <div>
              <div class="info-label">Issued</div>
              <div class="info-value">${new Date(license.issued).toLocaleDateString()}</div>
            </div>
            <div>
              <div class="info-label">Expires</div>
              <div class="info-value">${expiryDate.toLocaleDateString()}</div>
            </div>
          </div>

          <div style="margin-top: 16px;">
            <div class="info-label">Days Remaining</div>
            <div class="info-value" style="font-size: 16px; font-weight: 600;">
              ${daysLeft > 0 ? `${daysLeft} days` : 'Expired'}
            </div>
          </div>
        </div>

        <div style="text-align: center; margin-top: 20px;">
          <button class="button-secondary" onclick="clearForm()">Check Another License</button>
        </div>
      `;

      resultEl.classList.add('show');
      document.getElementById('formContainer').style.display = 'none';
    }

    function clearForm() {
      document.getElementById('softwareNumber').value = '';
      document.getElementById('licenseKey').value = '';
      document.getElementById('resultContainer').classList.remove('show');
      document.getElementById('formContainer').style.display = 'block';
      hideMessages();
    }

    function showHelp() {
      alert(`License Verification Help

1. Find your Software Number and License Key in the email you received

2. Paste them into the fields above

3. Click "Verify License"

4. Your license status will be shown

If you don't have your license information:
- Contact support@craftforge.example.com
- Include your email address used for purchase`);
    }

    function showActivation() {
      alert(`How to Activate CraftForge

1. Open CraftForge application

2. Go to: Help â†’ License Activation

3. Paste your Software Number: NM-XXXX-XXXX

4. Paste your License Key: XXXXX-XXXXX-XXXXX-XXXXX

5. Click Activate

Your license will be active for the duration shown.`);
    }

    // Allow Enter key to verify
    document.getElementById('licenseKey').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') verifyLicense();
    });
  </script>
</body>
</html>
